var exports;
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	// The require scope
/******/ 	var __webpack_require__ = {};
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "roundToNPlaces": () => (/* binding */ roundToNPlaces)
/* harmony export */ });
let canvas = document.getElementById("arrowBenchCanvas");
canvas.width = 1920;
canvas.height = 1080;
let ctx = canvas.getContext("2d");
let arrowCounter = document.getElementById("arrowCounter");
let fpsCounter = document.getElementById("fpsCounter");
let arrowsPerMsCounter = document.getElementById("arrowsPerMsCounter");
let arrowSize = 20;
let halfArrowSize = arrowSize / 2;
let noteskin4thPath = "../assets/noteskin_4th.png";
let noteskin8thPath = "../assets/noteskin_8th.png";
let noteskin12thPath = "../assets/noteskin_12th.png";
let noteskin16thPath = "../assets/noteskin_16th.png";
let noteskin20thPath = "../assets/noteskin_20th.png";
let noteskin24thPath = "../assets/noteskin_24th.png";
let noteskin32ndPath = "../assets/noteskin_32nd.png";
let noteskin48thPath = "../assets/noteskin_48th.png";
let noteskin64thPath = "../assets/noteskin_64th.png";
let noteskin96thPath = "../assets/noteskin_96th.png";
let noteskin128thPath = "../assets/noteskin_128th.png";
let noteskin192ndPath = "../assets/noteskin_192nd.png";
let preloadRegistry = new Map();
let arrowColors = [
    loadImage(noteskin4thPath),
    loadImage(noteskin8thPath),
    loadImage(noteskin12thPath),
    loadImage(noteskin16thPath),
    loadImage(noteskin20thPath),
    loadImage(noteskin24thPath),
    loadImage(noteskin32ndPath),
    loadImage(noteskin48thPath),
    loadImage(noteskin64thPath),
    loadImage(noteskin96thPath),
    loadImage(noteskin128thPath),
    loadImage(noteskin192ndPath),
];
let arrowCacheResized;
let arrowCacheNotResized;
function createResizedCache() {
    arrowCacheResized = [];
    for (let rotationIndex = 0; rotationIndex < 4; rotationIndex++) {
        let colorCache = [];
        for (let colorIndex = 0; colorIndex < arrowColors.length; colorIndex++) {
            let canvas = document.createElement("canvas");
            canvas.width = arrowSize;
            canvas.height = arrowSize;
            let ctx = canvas.getContext("2d");
            drawArrowToCacheResized(ctx, rotationIndex, colorIndex);
            colorCache.push(canvas);
        }
        arrowCacheResized.push(colorCache);
    }
}
function drawArrowToCacheResized(ctx, rotationIndex, colorIndex) {
    ctx.save();
    ctx.translate(halfArrowSize, halfArrowSize);
    ctx.rotate(rotationIndex * Math.PI / 2);
    ctx.drawImage(arrowColors[colorIndex], -halfArrowSize, -halfArrowSize, arrowSize, arrowSize);
    ctx.restore();
}
function createNotResizedCache() {
    arrowCacheNotResized = [];
    let arrowImageSize = arrowColors[0].height;
    for (let rotationIndex = 0; rotationIndex < 4; rotationIndex++) {
        let colorCache = [];
        for (let colorIndex = 0; colorIndex < arrowColors.length; colorIndex++) {
            let canvas = document.createElement("canvas");
            canvas.width = arrowImageSize;
            canvas.height = arrowImageSize;
            let ctx = canvas.getContext("2d");
            drawArrowToCacheNotResized(ctx, rotationIndex, colorIndex);
            colorCache.push(canvas);
        }
        arrowCacheNotResized.push(colorCache);
    }
}
function drawArrowToCacheNotResized(ctx, rotationIndex, colorIndex) {
    let arrowSize = arrowColors[colorIndex].height;
    let halfArrowSize = arrowSize / 2;
    ctx.save();
    ctx.translate(halfArrowSize, halfArrowSize);
    ctx.rotate(rotationIndex * Math.PI / 2);
    ctx.drawImage(arrowColors[colorIndex], -halfArrowSize, -halfArrowSize, arrowSize, arrowSize);
    ctx.restore();
}
// See this if I encounter weird loading problems later:
// https://stackoverflow.com/questions/12354865/image-onload-event-and-browser-cache
function loadImage(imageSource) {
    if (preloadRegistry.has(imageSource)) {
        throw new Error("You attempted to load the same image twice during preloading.");
    }
    preloadRegistry.set(imageSource, false);
    // The order these 3 things are done in is VERY important!
    let image = new Image();
    image.onload = () => {
        preloadRegistry.set(imageSource, true);
    };
    image.src = imageSource;
    return image;
}
let preloadIntervalId = setInterval(() => {
    if (preloadDone()) {
        clearInterval(preloadIntervalId);
        createResizedCache();
        createNotResizedCache();
        window.requestAnimationFrame(draw);
    }
}, 100);
function preloadDone() {
    for (let [key, loaded] of preloadRegistry) {
        if (!loaded) {
            return false;
        }
    }
    ;
    return true;
}
let mouseDown = false;
let mouseX = 0;
let mouseY = 0;
document.addEventListener("mousedown", (e) => { mouseDown = true; });
document.addEventListener("mouseup", (e) => { mouseDown = false; });
document.addEventListener("mousemove", (e) => {
    mouseX = e.clientX;
    mouseY = e.clientY;
});
let previousFrameTimes = [];
let numFrameTimesToRemember = 200;
let framesWithoutAStateChange = 0;
let arrows = [];
class Arrow {
}
let logCounter = 0;
let drawMethod = [
    drawArrow000,
    drawArrow001,
    drawArrow010,
    drawArrow011,
    // drawArrow100,
    // drawArrow101,
    // drawArrow110,
    // drawArrow111,
];
function draw(currentTimeMillis) {
    if (previousFrameTimes.length >= numFrameTimesToRemember) {
        previousFrameTimes.shift();
    }
    previousFrameTimes.push(currentTimeMillis);
    let deltaTimeMillis;
    if (previousFrameTimes.length > 1) {
        deltaTimeMillis = currentTimeMillis - previousFrameTimes[previousFrameTimes.length - 2];
    }
    // simulate the arrows
    if (previousFrameTimes.length > 1) {
        for (let i = 0; i < arrows.length; i++) {
            arrows[i].x += arrows[i].velocityX * deltaTimeMillis;
            arrows[i].y += arrows[i].velocityY * deltaTimeMillis;
            if (arrows[i].x - halfArrowSize < 0) { // donk on the left
                arrows[i].x += 2 * (halfArrowSize - arrows[i].x);
                arrows[i].velocityX = -arrows[i].velocityX;
            }
            if (arrows[i].y - halfArrowSize < 0) { // donk on the top
                arrows[i].y += 2 * (halfArrowSize - arrows[i].y);
                arrows[i].velocityY = -arrows[i].velocityY;
            }
            if (arrows[i].x + halfArrowSize > canvas.width) { // donk on the right
                arrows[i].x -= 2 * (arrows[i].x + halfArrowSize - canvas.width);
                arrows[i].velocityX = -arrows[i].velocityX;
            }
            if (arrows[i].y + halfArrowSize > canvas.height) { // donk on the bottom
                arrows[i].y -= 2 * (arrows[i].y + halfArrowSize - canvas.height);
                arrows[i].velocityY = -arrows[i].velocityY;
            }
        }
    }
    if (mouseDown) {
        for (let i = 0; i < 3; i++) {
            generateArrow();
        }
    }
    // update the top UI
    arrowCounter.innerText = arrows.length.toString();
    if (previousFrameTimes.length > 1) {
        fpsCounter.innerText = Math.round(1000 / deltaTimeMillis).toString();
    }
    else {
        fpsCounter.innerText = "calculating...";
    }
    if (framesWithoutAStateChange >= numFrameTimesToRemember) {
        arrowsPerMsCounter.innerText = roundToNPlaces(arrows.length
            / (currentTimeMillis - previousFrameTimes[0])
            * numFrameTimesToRemember, 2).toString();
    }
    else {
        arrowsPerMsCounter.innerText = "calculating...";
    }
    // read the state of the right UI
    let cacheRotationYes = document.getElementById("cacheRotationYes").checked;
    let cacheResizeYes = document.getElementById("cacheResizeYes").checked;
    let integerPositionYes = document.getElementById("integerPositionYes").checked;
    let drawMethodIndex = (cacheRotationYes ? 1 : 0)
        + (cacheResizeYes ? 2 : 0)
        + (integerPositionYes ? 4 : 0);
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    // draw the arrows
    for (let i = 0; i < arrows.length; i++) {
        drawMethod[drawMethodIndex](arrows[i]);
    }
    framesWithoutAStateChange++;
    window.requestAnimationFrame(draw);
}
function generateArrow() {
    let arrow = new Arrow();
    arrow.x = clampValueToRange(mouseX, 0, canvas.width);
    arrow.y = clampValueToRange(mouseY, 0, canvas.height);
    let velocityMagnitudePixelsPerMillisecond = 0.4;
    let randomAngle = Math.random() * 2 * Math.PI;
    arrow.velocityX = Math.cos(randomAngle) * velocityMagnitudePixelsPerMillisecond;
    arrow.velocityY = Math.sin(randomAngle) * velocityMagnitudePixelsPerMillisecond;
    arrow.colorIndex = getRandomIntInclusive(0, 11);
    arrow.rotationIndex = getRandomIntInclusive(0, 3);
    arrows.push(arrow);
    framesWithoutAStateChange = -1;
}
function clampValueToRange(value, lowerBound, upperBound) {
    if (value < lowerBound) {
        return lowerBound;
    }
    if (value > upperBound) {
        return upperBound;
    }
    return value;
}
function getRandomIntInclusive(min, max) {
    min = Math.ceil(min);
    max = Math.floor(max);
    return Math.floor(Math.random() * (max - min + 1) + min);
}
function drawArrow000(arrow) {
    let rotation = arrow.rotationIndex * Math.PI / 2;
    ctx.translate(arrow.x, arrow.y);
    ctx.rotate(rotation);
    ctx.drawImage(arrowColors[arrow.colorIndex], -halfArrowSize, -halfArrowSize, arrowSize, arrowSize);
    ctx.rotate(-rotation);
    ctx.translate(-arrow.x, -arrow.y);
}
function drawArrow010(arrow) {
    let cachedCanvas = arrowCacheResized[0][arrow.colorIndex];
    let rotation = arrow.rotationIndex * Math.PI / 2;
    ctx.translate(arrow.x, arrow.y);
    ctx.rotate(rotation);
    ctx.drawImage(cachedCanvas, -halfArrowSize, -halfArrowSize);
    ctx.rotate(-rotation);
    ctx.translate(-arrow.x, -arrow.y);
}
function drawArrow001(arrow) {
    let cachedCanvas = arrowCacheNotResized[arrow.rotationIndex][arrow.colorIndex];
    ctx.drawImage(cachedCanvas, arrow.x - halfArrowSize, arrow.y - halfArrowSize, arrowSize, arrowSize);
}
function drawArrow011(arrow) {
    let cachedCanvas = arrowCacheResized[arrow.rotationIndex][arrow.colorIndex];
    // ctx.save();
    // ctx.translate(arrow.x, arrow.y);
    // ctx.drawImage(cachedCanvas, -halfArrowSize, -halfArrowSize);
    ctx.drawImage(cachedCanvas, arrow.x - halfArrowSize, arrow.y - halfArrowSize);
    // ctx.restore();
}
function roundToNPlaces(x, numPlaces) {
    let scale = Math.pow(10, numPlaces);
    return Math.round(x * scale) / scale;
}

exports = __webpack_exports__;
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWlCO0FBQ3JCLENBQUM7QUFFTSxTQUFTLGNBQWMsQ0FBQyxDQUFTLEVBQUUsU0FBaUI7SUFDdkQsSUFBSSxLQUFLLEdBQVcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDNUMsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUMsR0FBRyxLQUFLLENBQUM7QUFDekMsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2V4cG9ydHMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vZXhwb3J0cy93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vZXhwb3J0cy93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL2V4cG9ydHMvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly9leHBvcnRzLy4vc3JjL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiXHJcbmxldCBjYW52YXMgPSA8SFRNTENhbnZhc0VsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXJyb3dCZW5jaENhbnZhc1wiKTtcclxuY2FudmFzLndpZHRoID0gMTkyMDtcclxuY2FudmFzLmhlaWdodCA9IDEwODA7XHJcbmxldCBjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcblxyXG5sZXQgYXJyb3dDb3VudGVyID0gPEhUTUxTcGFuRWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhcnJvd0NvdW50ZXJcIik7XHJcbmxldCBmcHNDb3VudGVyID0gPEhUTUxTcGFuRWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmcHNDb3VudGVyXCIpO1xyXG5sZXQgYXJyb3dzUGVyTXNDb3VudGVyID0gPEhUTUxTcGFuRWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhcnJvd3NQZXJNc0NvdW50ZXJcIik7XHJcblxyXG5sZXQgYXJyb3dTaXplOiBudW1iZXIgPSAyMDtcclxubGV0IGhhbGZBcnJvd1NpemU6IG51bWJlciA9IGFycm93U2l6ZSAvIDI7XHJcblxyXG5sZXQgbm90ZXNraW40dGhQYXRoOiBzdHJpbmcgPSBcIi4uL2Fzc2V0cy9ub3Rlc2tpbl80dGgucG5nXCI7XHJcbmxldCBub3Rlc2tpbjh0aFBhdGg6IHN0cmluZyA9IFwiLi4vYXNzZXRzL25vdGVza2luXzh0aC5wbmdcIjtcclxubGV0IG5vdGVza2luMTJ0aFBhdGg6IHN0cmluZyA9IFwiLi4vYXNzZXRzL25vdGVza2luXzEydGgucG5nXCI7XHJcbmxldCBub3Rlc2tpbjE2dGhQYXRoOiBzdHJpbmcgPSBcIi4uL2Fzc2V0cy9ub3Rlc2tpbl8xNnRoLnBuZ1wiO1xyXG5sZXQgbm90ZXNraW4yMHRoUGF0aDogc3RyaW5nID0gXCIuLi9hc3NldHMvbm90ZXNraW5fMjB0aC5wbmdcIjtcclxubGV0IG5vdGVza2luMjR0aFBhdGg6IHN0cmluZyA9IFwiLi4vYXNzZXRzL25vdGVza2luXzI0dGgucG5nXCI7XHJcbmxldCBub3Rlc2tpbjMybmRQYXRoOiBzdHJpbmcgPSBcIi4uL2Fzc2V0cy9ub3Rlc2tpbl8zMm5kLnBuZ1wiO1xyXG5sZXQgbm90ZXNraW40OHRoUGF0aDogc3RyaW5nID0gXCIuLi9hc3NldHMvbm90ZXNraW5fNDh0aC5wbmdcIjtcclxubGV0IG5vdGVza2luNjR0aFBhdGg6IHN0cmluZyA9IFwiLi4vYXNzZXRzL25vdGVza2luXzY0dGgucG5nXCI7XHJcbmxldCBub3Rlc2tpbjk2dGhQYXRoOiBzdHJpbmcgPSBcIi4uL2Fzc2V0cy9ub3Rlc2tpbl85NnRoLnBuZ1wiO1xyXG5sZXQgbm90ZXNraW4xMjh0aFBhdGg6IHN0cmluZyA9IFwiLi4vYXNzZXRzL25vdGVza2luXzEyOHRoLnBuZ1wiO1xyXG5sZXQgbm90ZXNraW4xOTJuZFBhdGg6IHN0cmluZyA9IFwiLi4vYXNzZXRzL25vdGVza2luXzE5Mm5kLnBuZ1wiO1xyXG5sZXQgcHJlbG9hZFJlZ2lzdHJ5OiBNYXA8c3RyaW5nLCBib29sZWFuPiA9IG5ldyBNYXAoKTtcclxuXHJcbmxldCBhcnJvd0NvbG9yczogSFRNTEltYWdlRWxlbWVudFtdID0gW1xyXG4gICAgbG9hZEltYWdlKG5vdGVza2luNHRoUGF0aCksXHJcbiAgICBsb2FkSW1hZ2Uobm90ZXNraW44dGhQYXRoKSxcclxuICAgIGxvYWRJbWFnZShub3Rlc2tpbjEydGhQYXRoKSxcclxuICAgIGxvYWRJbWFnZShub3Rlc2tpbjE2dGhQYXRoKSxcclxuICAgIGxvYWRJbWFnZShub3Rlc2tpbjIwdGhQYXRoKSxcclxuICAgIGxvYWRJbWFnZShub3Rlc2tpbjI0dGhQYXRoKSxcclxuICAgIGxvYWRJbWFnZShub3Rlc2tpbjMybmRQYXRoKSxcclxuICAgIGxvYWRJbWFnZShub3Rlc2tpbjQ4dGhQYXRoKSxcclxuICAgIGxvYWRJbWFnZShub3Rlc2tpbjY0dGhQYXRoKSxcclxuICAgIGxvYWRJbWFnZShub3Rlc2tpbjk2dGhQYXRoKSxcclxuICAgIGxvYWRJbWFnZShub3Rlc2tpbjEyOHRoUGF0aCksXHJcbiAgICBsb2FkSW1hZ2Uobm90ZXNraW4xOTJuZFBhdGgpLFxyXG5dO1xyXG5cclxubGV0IGFycm93Q2FjaGVSZXNpemVkOiBIVE1MQ2FudmFzRWxlbWVudFtdW107XHJcbmxldCBhcnJvd0NhY2hlTm90UmVzaXplZDogSFRNTENhbnZhc0VsZW1lbnRbXVtdO1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlUmVzaXplZENhY2hlKCkge1xyXG4gICAgYXJyb3dDYWNoZVJlc2l6ZWQgPSBbXTtcclxuICAgIGZvciAobGV0IHJvdGF0aW9uSW5kZXggPSAwOyByb3RhdGlvbkluZGV4IDwgNDsgcm90YXRpb25JbmRleCsrKSB7XHJcbiAgICAgICAgbGV0IGNvbG9yQ2FjaGU6IEhUTUxDYW52YXNFbGVtZW50W10gPSBbXVxyXG4gICAgICAgIGZvciAobGV0IGNvbG9ySW5kZXggPSAwOyBjb2xvckluZGV4IDwgYXJyb3dDb2xvcnMubGVuZ3RoOyBjb2xvckluZGV4KyspIHtcclxuICAgICAgICAgICAgbGV0IGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gICAgICAgICAgICBjYW52YXMud2lkdGggPSBhcnJvd1NpemU7XHJcbiAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSBhcnJvd1NpemU7XHJcbiAgICAgICAgICAgIGxldCBjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgIGRyYXdBcnJvd1RvQ2FjaGVSZXNpemVkKGN0eCwgcm90YXRpb25JbmRleCwgY29sb3JJbmRleCk7XHJcbiAgICAgICAgICAgIGNvbG9yQ2FjaGUucHVzaChjYW52YXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhcnJvd0NhY2hlUmVzaXplZC5wdXNoKGNvbG9yQ2FjaGUpO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBkcmF3QXJyb3dUb0NhY2hlUmVzaXplZChjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCwgcm90YXRpb25JbmRleDogbnVtYmVyLCBjb2xvckluZGV4OiBudW1iZXIpIHtcclxuICAgIGN0eC5zYXZlKCk7XHJcbiAgICBjdHgudHJhbnNsYXRlKGhhbGZBcnJvd1NpemUsIGhhbGZBcnJvd1NpemUpO1xyXG4gICAgY3R4LnJvdGF0ZShyb3RhdGlvbkluZGV4ICogTWF0aC5QSSAvIDIpO1xyXG4gICAgY3R4LmRyYXdJbWFnZShhcnJvd0NvbG9yc1tjb2xvckluZGV4XSwgLWhhbGZBcnJvd1NpemUsIC1oYWxmQXJyb3dTaXplLCBhcnJvd1NpemUsIGFycm93U2l6ZSk7XHJcbiAgICBjdHgucmVzdG9yZSgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVOb3RSZXNpemVkQ2FjaGUoKSB7XHJcbiAgICBhcnJvd0NhY2hlTm90UmVzaXplZCA9IFtdO1xyXG4gICAgbGV0IGFycm93SW1hZ2VTaXplOiBudW1iZXIgPSBhcnJvd0NvbG9yc1swXS5oZWlnaHQ7XHJcbiAgICBmb3IgKGxldCByb3RhdGlvbkluZGV4ID0gMDsgcm90YXRpb25JbmRleCA8IDQ7IHJvdGF0aW9uSW5kZXgrKykge1xyXG4gICAgICAgIGxldCBjb2xvckNhY2hlOiBIVE1MQ2FudmFzRWxlbWVudFtdID0gW11cclxuICAgICAgICBmb3IgKGxldCBjb2xvckluZGV4ID0gMDsgY29sb3JJbmRleCA8IGFycm93Q29sb3JzLmxlbmd0aDsgY29sb3JJbmRleCsrKSB7XHJcbiAgICAgICAgICAgIGxldCBjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcclxuICAgICAgICAgICAgY2FudmFzLndpZHRoID0gYXJyb3dJbWFnZVNpemU7XHJcbiAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSBhcnJvd0ltYWdlU2l6ZTtcclxuICAgICAgICAgICAgbGV0IGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICAgICAgICAgICAgZHJhd0Fycm93VG9DYWNoZU5vdFJlc2l6ZWQoY3R4LCByb3RhdGlvbkluZGV4LCBjb2xvckluZGV4KTtcclxuICAgICAgICAgICAgY29sb3JDYWNoZS5wdXNoKGNhbnZhcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFycm93Q2FjaGVOb3RSZXNpemVkLnB1c2goY29sb3JDYWNoZSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRyYXdBcnJvd1RvQ2FjaGVOb3RSZXNpemVkKGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCByb3RhdGlvbkluZGV4OiBudW1iZXIsIGNvbG9ySW5kZXg6IG51bWJlcikge1xyXG4gICAgbGV0IGFycm93U2l6ZTogbnVtYmVyID0gYXJyb3dDb2xvcnNbY29sb3JJbmRleF0uaGVpZ2h0O1xyXG4gICAgbGV0IGhhbGZBcnJvd1NpemUgPSBhcnJvd1NpemUgLyAyO1xyXG4gICAgY3R4LnNhdmUoKTtcclxuICAgIGN0eC50cmFuc2xhdGUoaGFsZkFycm93U2l6ZSwgaGFsZkFycm93U2l6ZSk7XHJcbiAgICBjdHgucm90YXRlKHJvdGF0aW9uSW5kZXggKiBNYXRoLlBJIC8gMik7XHJcbiAgICBjdHguZHJhd0ltYWdlKGFycm93Q29sb3JzW2NvbG9ySW5kZXhdLCAtaGFsZkFycm93U2l6ZSwgLWhhbGZBcnJvd1NpemUsIGFycm93U2l6ZSwgYXJyb3dTaXplKTtcclxuICAgIGN0eC5yZXN0b3JlKCk7XHJcbn1cclxuXHJcbi8vIFNlZSB0aGlzIGlmIEkgZW5jb3VudGVyIHdlaXJkIGxvYWRpbmcgcHJvYmxlbXMgbGF0ZXI6XHJcbi8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEyMzU0ODY1L2ltYWdlLW9ubG9hZC1ldmVudC1hbmQtYnJvd3Nlci1jYWNoZVxyXG5mdW5jdGlvbiBsb2FkSW1hZ2UoaW1hZ2VTb3VyY2U6IHN0cmluZyk6IEhUTUxJbWFnZUVsZW1lbnQge1xyXG4gICAgaWYgKHByZWxvYWRSZWdpc3RyeS5oYXMoaW1hZ2VTb3VyY2UpKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiWW91IGF0dGVtcHRlZCB0byBsb2FkIHRoZSBzYW1lIGltYWdlIHR3aWNlIGR1cmluZyBwcmVsb2FkaW5nLlwiKTtcclxuICAgIH1cclxuICAgIHByZWxvYWRSZWdpc3RyeS5zZXQoaW1hZ2VTb3VyY2UsIGZhbHNlKTtcclxuXHJcbiAgICAvLyBUaGUgb3JkZXIgdGhlc2UgMyB0aGluZ3MgYXJlIGRvbmUgaW4gaXMgVkVSWSBpbXBvcnRhbnQhXHJcbiAgICBsZXQgaW1hZ2UgPSBuZXcgSW1hZ2UoKTtcclxuICAgIGltYWdlLm9ubG9hZCA9ICgpID0+IHtcclxuICAgICAgICBwcmVsb2FkUmVnaXN0cnkuc2V0KGltYWdlU291cmNlLCB0cnVlKTtcclxuICAgIH1cclxuICAgIGltYWdlLnNyYyA9IGltYWdlU291cmNlO1xyXG5cclxuICAgIHJldHVybiBpbWFnZTtcclxufVxyXG5cclxubGV0IHByZWxvYWRJbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgaWYgKHByZWxvYWREb25lKCkpIHtcclxuICAgICAgICBjbGVhckludGVydmFsKHByZWxvYWRJbnRlcnZhbElkKTtcclxuICAgICAgICBjcmVhdGVSZXNpemVkQ2FjaGUoKTtcclxuICAgICAgICBjcmVhdGVOb3RSZXNpemVkQ2FjaGUoKTtcclxuICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGRyYXcpO1xyXG4gICAgfVxyXG59LCAxMDApO1xyXG5cclxuZnVuY3Rpb24gcHJlbG9hZERvbmUoKTogYm9vbGVhbiB7XHJcbiAgICBmb3IgKGxldCBba2V5LCBsb2FkZWRdIG9mIHByZWxvYWRSZWdpc3RyeSkge1xyXG4gICAgICAgIGlmICghbG9hZGVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbmxldCBtb3VzZURvd246IGJvb2xlYW4gPSBmYWxzZTtcclxubGV0IG1vdXNlWDogbnVtYmVyID0gMDtcclxubGV0IG1vdXNlWTogbnVtYmVyID0gMDtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGU6IE1vdXNlRXZlbnQpID0+IHsgbW91c2VEb3duID0gdHJ1ZTsgfSk7XHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIChlOiBNb3VzZUV2ZW50KSA9PiB7IG1vdXNlRG93biA9IGZhbHNlOyB9KTtcclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCAoZTogTW91c2VFdmVudCkgPT4ge1xyXG4gICAgbW91c2VYID0gZS5jbGllbnRYO1xyXG4gICAgbW91c2VZID0gZS5jbGllbnRZO1xyXG59KTtcclxuXHJcbmxldCBwcmV2aW91c0ZyYW1lVGltZXM6IG51bWJlcltdID0gW107XHJcbmxldCBudW1GcmFtZVRpbWVzVG9SZW1lbWJlcjogbnVtYmVyID0gMjAwO1xyXG5sZXQgZnJhbWVzV2l0aG91dEFTdGF0ZUNoYW5nZTogbnVtYmVyID0gMDtcclxuXHJcbmxldCBhcnJvd3M6IEFycm93W10gPSBbXTtcclxuXHJcbmNsYXNzIEFycm93IHtcclxuICAgIHB1YmxpYyB4OiBudW1iZXI7XHJcbiAgICBwdWJsaWMgeTogbnVtYmVyO1xyXG4gICAgcHVibGljIHZlbG9jaXR5WDogbnVtYmVyO1xyXG4gICAgcHVibGljIHZlbG9jaXR5WTogbnVtYmVyO1xyXG4gICAgcHVibGljIGNvbG9ySW5kZXg6IG51bWJlcjtcclxuICAgIHB1YmxpYyByb3RhdGlvbkluZGV4OiBudW1iZXI7XHJcbn1cclxuXHJcbmxldCBsb2dDb3VudGVyOiBudW1iZXIgPSAwO1xyXG5cclxubGV0IGRyYXdNZXRob2Q6ICgoYXJyb3c6IEFycm93KSA9PiB2b2lkKVtdID0gW1xyXG4gICAgZHJhd0Fycm93MDAwLFxyXG4gICAgZHJhd0Fycm93MDAxLFxyXG4gICAgZHJhd0Fycm93MDEwLFxyXG4gICAgZHJhd0Fycm93MDExLFxyXG4gICAgLy8gZHJhd0Fycm93MTAwLFxyXG4gICAgLy8gZHJhd0Fycm93MTAxLFxyXG4gICAgLy8gZHJhd0Fycm93MTEwLFxyXG4gICAgLy8gZHJhd0Fycm93MTExLFxyXG5dO1xyXG5cclxuZnVuY3Rpb24gZHJhdyhjdXJyZW50VGltZU1pbGxpczogbnVtYmVyKSB7XHJcbiAgICBpZiAocHJldmlvdXNGcmFtZVRpbWVzLmxlbmd0aCA+PSBudW1GcmFtZVRpbWVzVG9SZW1lbWJlcikge1xyXG4gICAgICAgIHByZXZpb3VzRnJhbWVUaW1lcy5zaGlmdCgpO1xyXG4gICAgfVxyXG4gICAgcHJldmlvdXNGcmFtZVRpbWVzLnB1c2goY3VycmVudFRpbWVNaWxsaXMpO1xyXG5cclxuICAgIGxldCBkZWx0YVRpbWVNaWxsaXM6IG51bWJlcjtcclxuICAgIGlmIChwcmV2aW91c0ZyYW1lVGltZXMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgIGRlbHRhVGltZU1pbGxpcyA9IGN1cnJlbnRUaW1lTWlsbGlzIC0gcHJldmlvdXNGcmFtZVRpbWVzW3ByZXZpb3VzRnJhbWVUaW1lcy5sZW5ndGggLSAyXTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBzaW11bGF0ZSB0aGUgYXJyb3dzXHJcbiAgICBpZiAocHJldmlvdXNGcmFtZVRpbWVzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFycm93cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBhcnJvd3NbaV0ueCArPSBhcnJvd3NbaV0udmVsb2NpdHlYICogZGVsdGFUaW1lTWlsbGlzO1xyXG4gICAgICAgICAgICBhcnJvd3NbaV0ueSArPSBhcnJvd3NbaV0udmVsb2NpdHlZICogZGVsdGFUaW1lTWlsbGlzO1xyXG5cclxuICAgICAgICAgICAgaWYgKGFycm93c1tpXS54IC0gaGFsZkFycm93U2l6ZSA8IDApIHsgLy8gZG9uayBvbiB0aGUgbGVmdFxyXG4gICAgICAgICAgICAgICAgYXJyb3dzW2ldLnggKz0gMiAqIChoYWxmQXJyb3dTaXplIC0gYXJyb3dzW2ldLngpO1xyXG4gICAgICAgICAgICAgICAgYXJyb3dzW2ldLnZlbG9jaXR5WCA9IC1hcnJvd3NbaV0udmVsb2NpdHlYO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhcnJvd3NbaV0ueSAtIGhhbGZBcnJvd1NpemUgPCAwKSB7IC8vIGRvbmsgb24gdGhlIHRvcFxyXG4gICAgICAgICAgICAgICAgYXJyb3dzW2ldLnkgKz0gMiAqIChoYWxmQXJyb3dTaXplIC0gYXJyb3dzW2ldLnkpO1xyXG4gICAgICAgICAgICAgICAgYXJyb3dzW2ldLnZlbG9jaXR5WSA9IC1hcnJvd3NbaV0udmVsb2NpdHlZO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhcnJvd3NbaV0ueCArIGhhbGZBcnJvd1NpemUgPiBjYW52YXMud2lkdGgpIHsgLy8gZG9uayBvbiB0aGUgcmlnaHRcclxuICAgICAgICAgICAgICAgIGFycm93c1tpXS54IC09IDIgKiAoYXJyb3dzW2ldLnggKyBoYWxmQXJyb3dTaXplIC0gY2FudmFzLndpZHRoKTtcclxuICAgICAgICAgICAgICAgIGFycm93c1tpXS52ZWxvY2l0eVggPSAtYXJyb3dzW2ldLnZlbG9jaXR5WDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoYXJyb3dzW2ldLnkgKyBoYWxmQXJyb3dTaXplID4gY2FudmFzLmhlaWdodCkgeyAvLyBkb25rIG9uIHRoZSBib3R0b21cclxuICAgICAgICAgICAgICAgIGFycm93c1tpXS55IC09IDIgKiAoYXJyb3dzW2ldLnkgKyBoYWxmQXJyb3dTaXplIC0gY2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICBhcnJvd3NbaV0udmVsb2NpdHlZID0gLWFycm93c1tpXS52ZWxvY2l0eVk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG1vdXNlRG93bikge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMzsgaSsrKSB7XHJcbiAgICAgICAgICAgIGdlbmVyYXRlQXJyb3coKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdXBkYXRlIHRoZSB0b3AgVUlcclxuICAgIGFycm93Q291bnRlci5pbm5lclRleHQgPSBhcnJvd3MubGVuZ3RoLnRvU3RyaW5nKCk7XHJcbiAgICBpZiAocHJldmlvdXNGcmFtZVRpbWVzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICBmcHNDb3VudGVyLmlubmVyVGV4dCA9IE1hdGgucm91bmQoMTAwMCAvIGRlbHRhVGltZU1pbGxpcykudG9TdHJpbmcoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZnBzQ291bnRlci5pbm5lclRleHQgPSBcImNhbGN1bGF0aW5nLi4uXCI7XHJcbiAgICB9XHJcbiAgICBpZiAoZnJhbWVzV2l0aG91dEFTdGF0ZUNoYW5nZSA+PSBudW1GcmFtZVRpbWVzVG9SZW1lbWJlcikge1xyXG4gICAgICAgIGFycm93c1Blck1zQ291bnRlci5pbm5lclRleHQgPSByb3VuZFRvTlBsYWNlcyhcclxuICAgICAgICAgICAgYXJyb3dzLmxlbmd0aFxyXG4gICAgICAgICAgICAvIChjdXJyZW50VGltZU1pbGxpcyAtIHByZXZpb3VzRnJhbWVUaW1lc1swXSlcclxuICAgICAgICAgICAgKiBudW1GcmFtZVRpbWVzVG9SZW1lbWJlclxyXG4gICAgICAgICAgICAsIDIpLnRvU3RyaW5nKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFycm93c1Blck1zQ291bnRlci5pbm5lclRleHQgPSBcImNhbGN1bGF0aW5nLi4uXCI7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmVhZCB0aGUgc3RhdGUgb2YgdGhlIHJpZ2h0IFVJXHJcbiAgICBsZXQgY2FjaGVSb3RhdGlvblllcyA9ICg8SFRNTElucHV0RWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYWNoZVJvdGF0aW9uWWVzXCIpKS5jaGVja2VkO1xyXG4gICAgbGV0IGNhY2hlUmVzaXplWWVzID0gKDxIVE1MSW5wdXRFbGVtZW50PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNhY2hlUmVzaXplWWVzXCIpKS5jaGVja2VkO1xyXG4gICAgbGV0IGludGVnZXJQb3NpdGlvblllcyA9ICg8SFRNTElucHV0RWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbnRlZ2VyUG9zaXRpb25ZZXNcIikpLmNoZWNrZWQ7XHJcbiAgICBsZXQgZHJhd01ldGhvZEluZGV4OiBudW1iZXIgPVxyXG4gICAgICAgIChjYWNoZVJvdGF0aW9uWWVzID8gMSA6IDApXHJcbiAgICAgICAgKyAoY2FjaGVSZXNpemVZZXMgPyAyIDogMClcclxuICAgICAgICArIChpbnRlZ2VyUG9zaXRpb25ZZXMgPyA0IDogMCk7XHJcblxyXG4gICAgY3R4LmNsZWFyUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xyXG5cclxuICAgIC8vIGRyYXcgdGhlIGFycm93c1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJvd3MubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBkcmF3TWV0aG9kW2RyYXdNZXRob2RJbmRleF0oYXJyb3dzW2ldKTtcclxuICAgIH1cclxuXHJcbiAgICBmcmFtZXNXaXRob3V0QVN0YXRlQ2hhbmdlKys7XHJcblxyXG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShkcmF3KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2VuZXJhdGVBcnJvdygpIHtcclxuICAgIGxldCBhcnJvdzogQXJyb3cgPSBuZXcgQXJyb3coKTtcclxuICAgIGFycm93LnggPSBjbGFtcFZhbHVlVG9SYW5nZShtb3VzZVgsIDAsIGNhbnZhcy53aWR0aCk7XHJcbiAgICBhcnJvdy55ID0gY2xhbXBWYWx1ZVRvUmFuZ2UobW91c2VZLCAwLCBjYW52YXMuaGVpZ2h0KTtcclxuICAgIFxyXG4gICAgbGV0IHZlbG9jaXR5TWFnbml0dWRlUGl4ZWxzUGVyTWlsbGlzZWNvbmQ6IG51bWJlciA9IDAuNDtcclxuICAgIGxldCByYW5kb21BbmdsZTogbnVtYmVyID0gTWF0aC5yYW5kb20oKSAqIDIgKiBNYXRoLlBJO1xyXG4gICAgYXJyb3cudmVsb2NpdHlYID0gTWF0aC5jb3MocmFuZG9tQW5nbGUpICogdmVsb2NpdHlNYWduaXR1ZGVQaXhlbHNQZXJNaWxsaXNlY29uZDtcclxuICAgIGFycm93LnZlbG9jaXR5WSA9IE1hdGguc2luKHJhbmRvbUFuZ2xlKSAqIHZlbG9jaXR5TWFnbml0dWRlUGl4ZWxzUGVyTWlsbGlzZWNvbmQ7XHJcblxyXG4gICAgYXJyb3cuY29sb3JJbmRleCA9IGdldFJhbmRvbUludEluY2x1c2l2ZSgwLCAxMSk7XHJcbiAgICBhcnJvdy5yb3RhdGlvbkluZGV4ID0gZ2V0UmFuZG9tSW50SW5jbHVzaXZlKDAsIDMpO1xyXG5cclxuICAgIGFycm93cy5wdXNoKGFycm93KTtcclxuICAgIGZyYW1lc1dpdGhvdXRBU3RhdGVDaGFuZ2UgPSAtMTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xhbXBWYWx1ZVRvUmFuZ2UodmFsdWU6IG51bWJlciwgbG93ZXJCb3VuZDogbnVtYmVyLCB1cHBlckJvdW5kOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgaWYgKHZhbHVlIDwgbG93ZXJCb3VuZCkge1xyXG4gICAgICAgIHJldHVybiBsb3dlckJvdW5kO1xyXG4gICAgfVxyXG4gICAgaWYgKHZhbHVlID4gdXBwZXJCb3VuZCkge1xyXG4gICAgICAgIHJldHVybiB1cHBlckJvdW5kO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRSYW5kb21JbnRJbmNsdXNpdmUobWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogbnVtYmVyIHtcclxuICAgIG1pbiA9IE1hdGguY2VpbChtaW4pO1xyXG4gICAgbWF4ID0gTWF0aC5mbG9vcihtYXgpO1xyXG4gICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSArIG1pbik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRyYXdBcnJvdzAwMChhcnJvdzogQXJyb3cpIHtcclxuICAgIGxldCByb3RhdGlvbjogbnVtYmVyID0gYXJyb3cucm90YXRpb25JbmRleCAqIE1hdGguUEkgLyAyO1xyXG4gICAgY3R4LnRyYW5zbGF0ZShhcnJvdy54LCBhcnJvdy55KTtcclxuICAgIGN0eC5yb3RhdGUocm90YXRpb24pO1xyXG4gICAgY3R4LmRyYXdJbWFnZShhcnJvd0NvbG9yc1thcnJvdy5jb2xvckluZGV4XSwgLWhhbGZBcnJvd1NpemUsIC1oYWxmQXJyb3dTaXplLCBhcnJvd1NpemUsIGFycm93U2l6ZSk7XHJcbiAgICBjdHgucm90YXRlKC1yb3RhdGlvbik7XHJcbiAgICBjdHgudHJhbnNsYXRlKC1hcnJvdy54LCAtYXJyb3cueSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRyYXdBcnJvdzAxMChhcnJvdzogQXJyb3cpIHtcclxuICAgIGxldCBjYWNoZWRDYW52YXM6IEhUTUxDYW52YXNFbGVtZW50ID0gYXJyb3dDYWNoZVJlc2l6ZWRbMF1bYXJyb3cuY29sb3JJbmRleF07XHJcbiAgICBsZXQgcm90YXRpb246IG51bWJlciA9IGFycm93LnJvdGF0aW9uSW5kZXggKiBNYXRoLlBJIC8gMjtcclxuICAgIGN0eC50cmFuc2xhdGUoYXJyb3cueCwgYXJyb3cueSk7XHJcbiAgICBjdHgucm90YXRlKHJvdGF0aW9uKTtcclxuICAgIGN0eC5kcmF3SW1hZ2UoY2FjaGVkQ2FudmFzLCAtaGFsZkFycm93U2l6ZSwgLWhhbGZBcnJvd1NpemUpO1xyXG4gICAgY3R4LnJvdGF0ZSgtcm90YXRpb24pO1xyXG4gICAgY3R4LnRyYW5zbGF0ZSgtYXJyb3cueCwgLWFycm93LnkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkcmF3QXJyb3cwMDEoYXJyb3c6IEFycm93KSB7XHJcbiAgICBsZXQgY2FjaGVkQ2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCA9IGFycm93Q2FjaGVOb3RSZXNpemVkW2Fycm93LnJvdGF0aW9uSW5kZXhdW2Fycm93LmNvbG9ySW5kZXhdO1xyXG4gICAgY3R4LmRyYXdJbWFnZShjYWNoZWRDYW52YXMsIGFycm93LnggLSBoYWxmQXJyb3dTaXplLCBhcnJvdy55IC0gaGFsZkFycm93U2l6ZSwgYXJyb3dTaXplLCBhcnJvd1NpemUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkcmF3QXJyb3cwMTEoYXJyb3c6IEFycm93KSB7XHJcbiAgICBsZXQgY2FjaGVkQ2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCA9IGFycm93Q2FjaGVSZXNpemVkW2Fycm93LnJvdGF0aW9uSW5kZXhdW2Fycm93LmNvbG9ySW5kZXhdO1xyXG4gICAgLy8gY3R4LnNhdmUoKTtcclxuXHJcbiAgICAvLyBjdHgudHJhbnNsYXRlKGFycm93LngsIGFycm93LnkpO1xyXG4gICAgLy8gY3R4LmRyYXdJbWFnZShjYWNoZWRDYW52YXMsIC1oYWxmQXJyb3dTaXplLCAtaGFsZkFycm93U2l6ZSk7XHJcbiAgICBjdHguZHJhd0ltYWdlKGNhY2hlZENhbnZhcywgYXJyb3cueCAtIGhhbGZBcnJvd1NpemUsIGFycm93LnkgLSBoYWxmQXJyb3dTaXplKTtcclxuXHJcbiAgICAvLyBjdHgucmVzdG9yZSgpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcm91bmRUb05QbGFjZXMoeDogbnVtYmVyLCBudW1QbGFjZXM6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICBsZXQgc2NhbGU6IG51bWJlciA9IE1hdGgucG93KDEwLCBudW1QbGFjZXMpO1xyXG4gICAgcmV0dXJuIE1hdGgucm91bmQoeCAqIHNjYWxlKSAvIHNjYWxlO1xyXG59XHJcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==