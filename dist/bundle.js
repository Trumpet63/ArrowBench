var exports;
/******/ (() => { // webpackBootstrap
var __webpack_exports__ = {};
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
let canvas = document.getElementById("arrowBenchCanvas");
canvas.width = 1920;
canvas.height = 1080;
let ctx = canvas.getContext("2d");
let arrowCounter = document.getElementById("arrowCounter");
let fpsCounter = document.getElementById("fpsCounter");
let arrowSize = 40;
let halfArrowSize = arrowSize / 2;
let noteskin4thPath = "../assets/noteskin_4th.png";
let noteskin8thPath = "../assets/noteskin_8th.png";
let noteskin12thPath = "../assets/noteskin_12th.png";
let noteskin16thPath = "../assets/noteskin_16th.png";
let noteskin20thPath = "../assets/noteskin_20th.png";
let noteskin24thPath = "../assets/noteskin_24th.png";
let noteskin32ndPath = "../assets/noteskin_32nd.png";
let noteskin48thPath = "../assets/noteskin_48th.png";
let noteskin64thPath = "../assets/noteskin_64th.png";
let noteskin96thPath = "../assets/noteskin_96th.png";
let noteskin128thPath = "../assets/noteskin_128th.png";
let noteskin192ndPath = "../assets/noteskin_192nd.png";
let preloadRegistry = new Map();
let arrowColors = [
    loadImage(noteskin4thPath),
    loadImage(noteskin8thPath),
    loadImage(noteskin12thPath),
    loadImage(noteskin16thPath),
    loadImage(noteskin20thPath),
    loadImage(noteskin24thPath),
    loadImage(noteskin32ndPath),
    loadImage(noteskin48thPath),
    loadImage(noteskin64thPath),
    loadImage(noteskin96thPath),
    loadImage(noteskin128thPath),
    loadImage(noteskin192ndPath),
];
let arrowCacheResized;
let arrowCacheNotResized;
function createResizedCache() {
    arrowCacheResized = [];
    for (let rotationIndex = 0; rotationIndex < 4; rotationIndex++) {
        let colorCache = [];
        for (let colorIndex = 0; colorIndex < arrowColors.length; colorIndex++) {
            let canvas = document.createElement("canvas");
            canvas.width = arrowSize;
            canvas.height = arrowSize;
            let ctx = canvas.getContext("2d");
            drawArrowToCacheResized(ctx, rotationIndex, colorIndex);
            colorCache.push(canvas);
        }
        arrowCacheResized.push(colorCache);
    }
}
function drawArrowToCacheResized(ctx, rotationIndex, colorIndex) {
    ctx.save();
    ctx.translate(halfArrowSize, halfArrowSize);
    ctx.rotate(rotationIndex * Math.PI / 2);
    ctx.drawImage(arrowColors[colorIndex], -halfArrowSize, -halfArrowSize, arrowSize, arrowSize);
    ctx.restore();
}
function createNotResizedCache() {
    arrowCacheNotResized = [];
    for (let rotationIndex = 0; rotationIndex < 4; rotationIndex++) {
        let colorCache = [];
        for (let colorIndex = 0; colorIndex < arrowColors.length; colorIndex++) {
            let canvas = document.createElement("canvas");
            canvas.width = arrowSize;
            canvas.height = arrowSize;
            let ctx = canvas.getContext("2d");
            drawArrowToCacheNotResized(ctx, rotationIndex, colorIndex);
            colorCache.push(canvas);
        }
        arrowCacheNotResized.push(colorCache);
    }
}
function drawArrowToCacheNotResized(ctx, rotationIndex, colorIndex) {
    let arrowSize = arrowColors[colorIndex].height;
    let halfArrowSize = arrowSize / 2;
    ctx.save();
    ctx.translate(halfArrowSize, halfArrowSize);
    ctx.rotate(rotationIndex * Math.PI / 2);
    ctx.drawImage(arrowColors[colorIndex], -halfArrowSize, -halfArrowSize, arrowSize, arrowSize);
    ctx.restore();
}
// See this if I encounter weird loading problems later:
// https://stackoverflow.com/questions/12354865/image-onload-event-and-browser-cache
function loadImage(imageSource) {
    if (preloadRegistry.has(imageSource)) {
        throw new Error("You attempted to load the same image twice during preloading.");
    }
    preloadRegistry.set(imageSource, false);
    // The order these 3 things are done in is VERY important!
    let image = new Image();
    image.onload = () => {
        preloadRegistry.set(imageSource, true);
    };
    image.src = imageSource;
    return image;
}
let preloadIntervalId = setInterval(() => {
    if (preloadDone()) {
        clearInterval(preloadIntervalId);
        createResizedCache();
        createNotResizedCache();
        window.requestAnimationFrame(draw);
    }
}, 100);
function preloadDone() {
    for (let [key, loaded] of preloadRegistry) {
        if (!loaded) {
            return false;
        }
    }
    ;
    return true;
}
let mouseDown = false;
let mouseX = 0;
let mouseY = 0;
document.addEventListener("mousedown", (e) => { mouseDown = true; });
document.addEventListener("mouseup", (e) => { mouseDown = false; });
document.addEventListener("mousemove", (e) => {
    mouseX = e.clientX;
    mouseY = e.clientY;
});
let previousFrameTimes = [];
let numFrameTimesToRemember = 100;
let arrows = [];
class Arrow {
}
let logCounter = 0;
function draw(currentTimeMillis) {
    if (previousFrameTimes.length >= numFrameTimesToRemember) {
        previousFrameTimes.shift();
    }
    previousFrameTimes.push(currentTimeMillis);
    let deltaTimeMillis;
    if (previousFrameTimes.length > 1) {
        deltaTimeMillis = currentTimeMillis - previousFrameTimes[previousFrameTimes.length - 2];
    }
    // simiulate the arrows
    if (previousFrameTimes.length > 1) {
        for (let i = 0; i < arrows.length; i++) {
            arrows[i].x += arrows[i].velocityX * deltaTimeMillis;
            arrows[i].y += arrows[i].velocityY * deltaTimeMillis;
            if (arrows[i].x - halfArrowSize < 0) { // donk on the left
                arrows[i].x += 2 * (halfArrowSize - arrows[i].x);
                arrows[i].velocityX = -arrows[i].velocityX;
            }
            if (arrows[i].y - halfArrowSize < 0) { // donk on the top
                arrows[i].y += 2 * (halfArrowSize - arrows[i].y);
                arrows[i].velocityY = -arrows[i].velocityY;
            }
            if (arrows[i].x + halfArrowSize > canvas.width) { // donk on the right
                arrows[i].x -= 2 * (arrows[i].x + halfArrowSize - canvas.width);
                arrows[i].velocityX = -arrows[i].velocityX;
            }
            if (arrows[i].y + halfArrowSize > canvas.height) { // donk on the bottom
                arrows[i].y -= 2 * (arrows[i].y + halfArrowSize - canvas.height);
                arrows[i].velocityY = -arrows[i].velocityY;
            }
        }
    }
    if (mouseDown) {
        generateArrow();
    }
    // update the UI
    arrowCounter.innerText = arrows.length.toString();
    if (previousFrameTimes.length > 1) {
        fpsCounter.innerHTML = Math.round(1000 / deltaTimeMillis).toString();
    }
    else {
        fpsCounter.innerHTML = "unknown";
    }
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    // draw the arrows
    for (let i = 0; i < arrows.length; i++) {
        drawArrow(arrows[i]);
    }
    window.requestAnimationFrame(draw);
}
function generateArrow() {
    let arrow = new Arrow();
    arrow.x = clampValueToRange(mouseX, 0, canvas.width);
    arrow.y = clampValueToRange(mouseY, 0, canvas.height);
    let velocityMagnitudePixelsPerMillisecond = 0.4;
    let randomAngle = Math.random() * 2 * Math.PI;
    arrow.velocityX = Math.cos(randomAngle) * velocityMagnitudePixelsPerMillisecond;
    arrow.velocityY = Math.sin(randomAngle) * velocityMagnitudePixelsPerMillisecond;
    arrow.colorIndex = getRandomIntInclusive(0, 11);
    arrow.rotationIndex = getRandomIntInclusive(0, 3);
    arrows.push(arrow);
}
function clampValueToRange(value, lowerBound, upperBound) {
    if (value < lowerBound) {
        return lowerBound;
    }
    if (value > upperBound) {
        return upperBound;
    }
    return value;
}
function getRandomIntInclusive(min, max) {
    min = Math.ceil(min);
    max = Math.floor(max);
    return Math.floor(Math.random() * (max - min + 1) + min);
}
function drawArrow(arrow) {
    ctx.save();
    ctx.translate(arrow.x, arrow.y);
    ctx.rotate(arrow.rotationIndex * Math.PI / 2);
    ctx.drawImage(arrowColors[arrow.colorIndex], -halfArrowSize, -halfArrowSize, arrowSize, arrowSize);
    ctx.restore();
}
function drawArrowNoResizing(arrow) {
    let cachedCanvas = arrowCacheResized[0][arrow.colorIndex];
    ctx.save();
    ctx.translate(arrow.x, arrow.y);
    ctx.rotate(arrow.rotationIndex * Math.PI / 2);
    ctx.drawImage(cachedCanvas, -halfArrowSize, -halfArrowSize, arrowSize, arrowSize);
    ctx.restore();
}
function drawArrowNoRotating(arrow) {
    let cachedCanvas = arrowCacheNotResized[arrow.rotationIndex][arrow.colorIndex];
    ctx.save();
    ctx.drawImage(cachedCanvas, arrow.x - halfArrowSize, arrow.y - halfArrowSize, arrowSize, arrowSize);
    ctx.restore();
}
function drawArrowNoReszingOrRotating(arrow) {
    let cachedCanvas = arrowCacheResized[arrow.rotationIndex][arrow.colorIndex];
    ctx.save();
    ctx.drawImage(cachedCanvas, arrow.x - halfArrowSize, arrow.y - halfArrowSize, arrowSize, arrowSize);
    ctx.restore();
}

exports = __webpack_exports__;
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FBRyxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ1gsR0FBRyxDQUFDLFNBQVMsQ0FBQyxZQUFZLEVBQUUsS0FBSyxDQUFDLENBQUMsR0FBRyxhQUFhLEVBQUUsS0FBSyxDQUFDLENBQUMsR0FBRyxhQUFhLEVBQUUsU0FBUyxFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBQ3BHLEdBQUcsQ0FBQyxPQUFPLEVBQUUsQ0FBQztBQUNsQixDQUFDO0FBRUQsU0FBUyw0QkFBNEIsQ0FBQyxLQUFZO0lBQzlDLElBQUksWUFBWSxHQUFzQixpQkFBaUIsQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQy9GLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNYLEdBQUcsQ0FBQyxTQUFTLENBQUMsWUFBWSxFQUFFLEtBQUssQ0FBQyxDQUFDLEdBQUcsYUFBYSxFQUFFLEtBQUssQ0FBQyxDQUFDLEdBQUcsYUFBYSxFQUFFLFNBQVMsRUFBRSxTQUFTLENBQUMsQ0FBQztJQUNwRyxHQUFHLENBQUMsT0FBTyxFQUFFLENBQUM7QUFDbEIsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2V4cG9ydHMvLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXHJcbmxldCBjYW52YXMgPSA8SFRNTENhbnZhc0VsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXJyb3dCZW5jaENhbnZhc1wiKTtcclxuY2FudmFzLndpZHRoID0gMTkyMDtcclxuY2FudmFzLmhlaWdodCA9IDEwODA7XHJcbmxldCBjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcblxyXG5sZXQgYXJyb3dDb3VudGVyID0gPEhUTUxTcGFuRWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhcnJvd0NvdW50ZXJcIik7XHJcbmxldCBmcHNDb3VudGVyID0gPEhUTUxTcGFuRWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmcHNDb3VudGVyXCIpO1xyXG5cclxubGV0IGFycm93U2l6ZTogbnVtYmVyID0gNDA7XHJcbmxldCBoYWxmQXJyb3dTaXplOiBudW1iZXIgPSBhcnJvd1NpemUgLyAyO1xyXG5cclxubGV0IG5vdGVza2luNHRoUGF0aDogc3RyaW5nID0gXCIuLi9hc3NldHMvbm90ZXNraW5fNHRoLnBuZ1wiO1xyXG5sZXQgbm90ZXNraW44dGhQYXRoOiBzdHJpbmcgPSBcIi4uL2Fzc2V0cy9ub3Rlc2tpbl84dGgucG5nXCI7XHJcbmxldCBub3Rlc2tpbjEydGhQYXRoOiBzdHJpbmcgPSBcIi4uL2Fzc2V0cy9ub3Rlc2tpbl8xMnRoLnBuZ1wiO1xyXG5sZXQgbm90ZXNraW4xNnRoUGF0aDogc3RyaW5nID0gXCIuLi9hc3NldHMvbm90ZXNraW5fMTZ0aC5wbmdcIjtcclxubGV0IG5vdGVza2luMjB0aFBhdGg6IHN0cmluZyA9IFwiLi4vYXNzZXRzL25vdGVza2luXzIwdGgucG5nXCI7XHJcbmxldCBub3Rlc2tpbjI0dGhQYXRoOiBzdHJpbmcgPSBcIi4uL2Fzc2V0cy9ub3Rlc2tpbl8yNHRoLnBuZ1wiO1xyXG5sZXQgbm90ZXNraW4zMm5kUGF0aDogc3RyaW5nID0gXCIuLi9hc3NldHMvbm90ZXNraW5fMzJuZC5wbmdcIjtcclxubGV0IG5vdGVza2luNDh0aFBhdGg6IHN0cmluZyA9IFwiLi4vYXNzZXRzL25vdGVza2luXzQ4dGgucG5nXCI7XHJcbmxldCBub3Rlc2tpbjY0dGhQYXRoOiBzdHJpbmcgPSBcIi4uL2Fzc2V0cy9ub3Rlc2tpbl82NHRoLnBuZ1wiO1xyXG5sZXQgbm90ZXNraW45NnRoUGF0aDogc3RyaW5nID0gXCIuLi9hc3NldHMvbm90ZXNraW5fOTZ0aC5wbmdcIjtcclxubGV0IG5vdGVza2luMTI4dGhQYXRoOiBzdHJpbmcgPSBcIi4uL2Fzc2V0cy9ub3Rlc2tpbl8xMjh0aC5wbmdcIjtcclxubGV0IG5vdGVza2luMTkybmRQYXRoOiBzdHJpbmcgPSBcIi4uL2Fzc2V0cy9ub3Rlc2tpbl8xOTJuZC5wbmdcIjtcclxubGV0IHByZWxvYWRSZWdpc3RyeTogTWFwPHN0cmluZywgYm9vbGVhbj4gPSBuZXcgTWFwKCk7XHJcblxyXG5sZXQgYXJyb3dDb2xvcnM6IEhUTUxJbWFnZUVsZW1lbnRbXSA9IFtcclxuICAgIGxvYWRJbWFnZShub3Rlc2tpbjR0aFBhdGgpLFxyXG4gICAgbG9hZEltYWdlKG5vdGVza2luOHRoUGF0aCksXHJcbiAgICBsb2FkSW1hZ2Uobm90ZXNraW4xMnRoUGF0aCksXHJcbiAgICBsb2FkSW1hZ2Uobm90ZXNraW4xNnRoUGF0aCksXHJcbiAgICBsb2FkSW1hZ2Uobm90ZXNraW4yMHRoUGF0aCksXHJcbiAgICBsb2FkSW1hZ2Uobm90ZXNraW4yNHRoUGF0aCksXHJcbiAgICBsb2FkSW1hZ2Uobm90ZXNraW4zMm5kUGF0aCksXHJcbiAgICBsb2FkSW1hZ2Uobm90ZXNraW40OHRoUGF0aCksXHJcbiAgICBsb2FkSW1hZ2Uobm90ZXNraW42NHRoUGF0aCksXHJcbiAgICBsb2FkSW1hZ2Uobm90ZXNraW45NnRoUGF0aCksXHJcbiAgICBsb2FkSW1hZ2Uobm90ZXNraW4xMjh0aFBhdGgpLFxyXG4gICAgbG9hZEltYWdlKG5vdGVza2luMTkybmRQYXRoKSxcclxuXTtcclxuXHJcbmxldCBhcnJvd0NhY2hlUmVzaXplZDogSFRNTENhbnZhc0VsZW1lbnRbXVtdO1xyXG5sZXQgYXJyb3dDYWNoZU5vdFJlc2l6ZWQ6IEhUTUxDYW52YXNFbGVtZW50W11bXTtcclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZVJlc2l6ZWRDYWNoZSgpIHtcclxuICAgIGFycm93Q2FjaGVSZXNpemVkID0gW107XHJcbiAgICBmb3IgKGxldCByb3RhdGlvbkluZGV4ID0gMDsgcm90YXRpb25JbmRleCA8IDQ7IHJvdGF0aW9uSW5kZXgrKykge1xyXG4gICAgICAgIGxldCBjb2xvckNhY2hlOiBIVE1MQ2FudmFzRWxlbWVudFtdID0gW11cclxuICAgICAgICBmb3IgKGxldCBjb2xvckluZGV4ID0gMDsgY29sb3JJbmRleCA8IGFycm93Q29sb3JzLmxlbmd0aDsgY29sb3JJbmRleCsrKSB7XHJcbiAgICAgICAgICAgIGxldCBjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcclxuICAgICAgICAgICAgY2FudmFzLndpZHRoID0gYXJyb3dTaXplO1xyXG4gICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gYXJyb3dTaXplO1xyXG4gICAgICAgICAgICBsZXQgY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gICAgICAgICAgICBkcmF3QXJyb3dUb0NhY2hlUmVzaXplZChjdHgsIHJvdGF0aW9uSW5kZXgsIGNvbG9ySW5kZXgpO1xyXG4gICAgICAgICAgICBjb2xvckNhY2hlLnB1c2goY2FudmFzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYXJyb3dDYWNoZVJlc2l6ZWQucHVzaChjb2xvckNhY2hlKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZHJhd0Fycm93VG9DYWNoZVJlc2l6ZWQoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsIHJvdGF0aW9uSW5kZXg6IG51bWJlciwgY29sb3JJbmRleDogbnVtYmVyKSB7XHJcbiAgICBjdHguc2F2ZSgpO1xyXG4gICAgY3R4LnRyYW5zbGF0ZShoYWxmQXJyb3dTaXplLCBoYWxmQXJyb3dTaXplKTtcclxuICAgIGN0eC5yb3RhdGUocm90YXRpb25JbmRleCAqIE1hdGguUEkgLyAyKTtcclxuICAgIGN0eC5kcmF3SW1hZ2UoYXJyb3dDb2xvcnNbY29sb3JJbmRleF0sIC1oYWxmQXJyb3dTaXplLCAtaGFsZkFycm93U2l6ZSwgYXJyb3dTaXplLCBhcnJvd1NpemUpO1xyXG4gICAgY3R4LnJlc3RvcmUoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlTm90UmVzaXplZENhY2hlKCkge1xyXG4gICAgYXJyb3dDYWNoZU5vdFJlc2l6ZWQgPSBbXTtcclxuICAgIGZvciAobGV0IHJvdGF0aW9uSW5kZXggPSAwOyByb3RhdGlvbkluZGV4IDwgNDsgcm90YXRpb25JbmRleCsrKSB7XHJcbiAgICAgICAgbGV0IGNvbG9yQ2FjaGU6IEhUTUxDYW52YXNFbGVtZW50W10gPSBbXVxyXG4gICAgICAgIGZvciAobGV0IGNvbG9ySW5kZXggPSAwOyBjb2xvckluZGV4IDwgYXJyb3dDb2xvcnMubGVuZ3RoOyBjb2xvckluZGV4KyspIHtcclxuICAgICAgICAgICAgbGV0IGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gICAgICAgICAgICBjYW52YXMud2lkdGggPSBhcnJvd1NpemU7XHJcbiAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSBhcnJvd1NpemU7XHJcbiAgICAgICAgICAgIGxldCBjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgIGRyYXdBcnJvd1RvQ2FjaGVOb3RSZXNpemVkKGN0eCwgcm90YXRpb25JbmRleCwgY29sb3JJbmRleCk7XHJcbiAgICAgICAgICAgIGNvbG9yQ2FjaGUucHVzaChjYW52YXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhcnJvd0NhY2hlTm90UmVzaXplZC5wdXNoKGNvbG9yQ2FjaGUpO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBkcmF3QXJyb3dUb0NhY2hlTm90UmVzaXplZChjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCwgcm90YXRpb25JbmRleDogbnVtYmVyLCBjb2xvckluZGV4OiBudW1iZXIpIHtcclxuICAgIGxldCBhcnJvd1NpemU6IG51bWJlciA9IGFycm93Q29sb3JzW2NvbG9ySW5kZXhdLmhlaWdodDtcclxuICAgIGxldCBoYWxmQXJyb3dTaXplID0gYXJyb3dTaXplIC8gMjtcclxuICAgIGN0eC5zYXZlKCk7XHJcbiAgICBjdHgudHJhbnNsYXRlKGhhbGZBcnJvd1NpemUsIGhhbGZBcnJvd1NpemUpO1xyXG4gICAgY3R4LnJvdGF0ZShyb3RhdGlvbkluZGV4ICogTWF0aC5QSSAvIDIpO1xyXG4gICAgY3R4LmRyYXdJbWFnZShhcnJvd0NvbG9yc1tjb2xvckluZGV4XSwgLWhhbGZBcnJvd1NpemUsIC1oYWxmQXJyb3dTaXplLCBhcnJvd1NpemUsIGFycm93U2l6ZSk7XHJcbiAgICBjdHgucmVzdG9yZSgpO1xyXG59XHJcblxyXG4vLyBTZWUgdGhpcyBpZiBJIGVuY291bnRlciB3ZWlyZCBsb2FkaW5nIHByb2JsZW1zIGxhdGVyOlxyXG4vLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMjM1NDg2NS9pbWFnZS1vbmxvYWQtZXZlbnQtYW5kLWJyb3dzZXItY2FjaGVcclxuZnVuY3Rpb24gbG9hZEltYWdlKGltYWdlU291cmNlOiBzdHJpbmcpOiBIVE1MSW1hZ2VFbGVtZW50IHtcclxuICAgIGlmIChwcmVsb2FkUmVnaXN0cnkuaGFzKGltYWdlU291cmNlKSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIllvdSBhdHRlbXB0ZWQgdG8gbG9hZCB0aGUgc2FtZSBpbWFnZSB0d2ljZSBkdXJpbmcgcHJlbG9hZGluZy5cIik7XHJcbiAgICB9XHJcbiAgICBwcmVsb2FkUmVnaXN0cnkuc2V0KGltYWdlU291cmNlLCBmYWxzZSk7XHJcblxyXG4gICAgLy8gVGhlIG9yZGVyIHRoZXNlIDMgdGhpbmdzIGFyZSBkb25lIGluIGlzIFZFUlkgaW1wb3J0YW50IVxyXG4gICAgbGV0IGltYWdlID0gbmV3IEltYWdlKCk7XHJcbiAgICBpbWFnZS5vbmxvYWQgPSAoKSA9PiB7XHJcbiAgICAgICAgcHJlbG9hZFJlZ2lzdHJ5LnNldChpbWFnZVNvdXJjZSwgdHJ1ZSk7XHJcbiAgICB9XHJcbiAgICBpbWFnZS5zcmMgPSBpbWFnZVNvdXJjZTtcclxuXHJcbiAgICByZXR1cm4gaW1hZ2U7XHJcbn1cclxuXHJcbmxldCBwcmVsb2FkSW50ZXJ2YWxJZCA9IHNldEludGVydmFsKCgpID0+IHtcclxuICAgIGlmIChwcmVsb2FkRG9uZSgpKSB7XHJcbiAgICAgICAgY2xlYXJJbnRlcnZhbChwcmVsb2FkSW50ZXJ2YWxJZCk7XHJcbiAgICAgICAgY3JlYXRlUmVzaXplZENhY2hlKCk7XHJcbiAgICAgICAgY3JlYXRlTm90UmVzaXplZENhY2hlKCk7XHJcbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShkcmF3KTtcclxuICAgIH1cclxufSwgMTAwKTtcclxuXHJcbmZ1bmN0aW9uIHByZWxvYWREb25lKCk6IGJvb2xlYW4ge1xyXG4gICAgZm9yIChsZXQgW2tleSwgbG9hZGVkXSBvZiBwcmVsb2FkUmVnaXN0cnkpIHtcclxuICAgICAgICBpZiAoIWxvYWRlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiB0cnVlO1xyXG59XHJcblxyXG5sZXQgbW91c2VEb3duOiBib29sZWFuID0gZmFsc2U7XHJcbmxldCBtb3VzZVg6IG51bWJlciA9IDA7XHJcbmxldCBtb3VzZVk6IG51bWJlciA9IDA7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChlOiBNb3VzZUV2ZW50KSA9PiB7IG1vdXNlRG93biA9IHRydWU7IH0pO1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCAoZTogTW91c2VFdmVudCkgPT4geyBtb3VzZURvd24gPSBmYWxzZTsgfSk7XHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgKGU6IE1vdXNlRXZlbnQpID0+IHtcclxuICAgIG1vdXNlWCA9IGUuY2xpZW50WDtcclxuICAgIG1vdXNlWSA9IGUuY2xpZW50WTtcclxufSk7XHJcblxyXG5sZXQgcHJldmlvdXNGcmFtZVRpbWVzOiBudW1iZXJbXSA9IFtdO1xyXG5sZXQgbnVtRnJhbWVUaW1lc1RvUmVtZW1iZXI6IG51bWJlciA9IDEwMDtcclxuXHJcbmxldCBhcnJvd3M6IEFycm93W10gPSBbXTtcclxuXHJcbmNsYXNzIEFycm93IHtcclxuICAgIHB1YmxpYyB4OiBudW1iZXI7XHJcbiAgICBwdWJsaWMgeTogbnVtYmVyO1xyXG4gICAgcHVibGljIHZlbG9jaXR5WDogbnVtYmVyO1xyXG4gICAgcHVibGljIHZlbG9jaXR5WTogbnVtYmVyO1xyXG4gICAgcHVibGljIGNvbG9ySW5kZXg6IG51bWJlcjtcclxuICAgIHB1YmxpYyByb3RhdGlvbkluZGV4OiBudW1iZXI7XHJcbn1cclxuXHJcbmxldCBsb2dDb3VudGVyOiBudW1iZXIgPSAwO1xyXG5cclxuZnVuY3Rpb24gZHJhdyhjdXJyZW50VGltZU1pbGxpczogbnVtYmVyKSB7XHJcbiAgICBpZiAocHJldmlvdXNGcmFtZVRpbWVzLmxlbmd0aCA+PSBudW1GcmFtZVRpbWVzVG9SZW1lbWJlcikge1xyXG4gICAgICAgIHByZXZpb3VzRnJhbWVUaW1lcy5zaGlmdCgpO1xyXG4gICAgfVxyXG4gICAgcHJldmlvdXNGcmFtZVRpbWVzLnB1c2goY3VycmVudFRpbWVNaWxsaXMpO1xyXG5cclxuICAgIGxldCBkZWx0YVRpbWVNaWxsaXM6IG51bWJlcjtcclxuICAgIGlmIChwcmV2aW91c0ZyYW1lVGltZXMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgIGRlbHRhVGltZU1pbGxpcyA9IGN1cnJlbnRUaW1lTWlsbGlzIC0gcHJldmlvdXNGcmFtZVRpbWVzW3ByZXZpb3VzRnJhbWVUaW1lcy5sZW5ndGggLSAyXTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBzaW1pdWxhdGUgdGhlIGFycm93c1xyXG4gICAgaWYgKHByZXZpb3VzRnJhbWVUaW1lcy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJvd3MubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgYXJyb3dzW2ldLnggKz0gYXJyb3dzW2ldLnZlbG9jaXR5WCAqIGRlbHRhVGltZU1pbGxpcztcclxuICAgICAgICAgICAgYXJyb3dzW2ldLnkgKz0gYXJyb3dzW2ldLnZlbG9jaXR5WSAqIGRlbHRhVGltZU1pbGxpcztcclxuXHJcbiAgICAgICAgICAgIGlmIChhcnJvd3NbaV0ueCAtIGhhbGZBcnJvd1NpemUgPCAwKSB7IC8vIGRvbmsgb24gdGhlIGxlZnRcclxuICAgICAgICAgICAgICAgIGFycm93c1tpXS54ICs9IDIgKiAoaGFsZkFycm93U2l6ZSAtIGFycm93c1tpXS54KTtcclxuICAgICAgICAgICAgICAgIGFycm93c1tpXS52ZWxvY2l0eVggPSAtYXJyb3dzW2ldLnZlbG9jaXR5WDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoYXJyb3dzW2ldLnkgLSBoYWxmQXJyb3dTaXplIDwgMCkgeyAvLyBkb25rIG9uIHRoZSB0b3BcclxuICAgICAgICAgICAgICAgIGFycm93c1tpXS55ICs9IDIgKiAoaGFsZkFycm93U2l6ZSAtIGFycm93c1tpXS55KTtcclxuICAgICAgICAgICAgICAgIGFycm93c1tpXS52ZWxvY2l0eVkgPSAtYXJyb3dzW2ldLnZlbG9jaXR5WTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoYXJyb3dzW2ldLnggKyBoYWxmQXJyb3dTaXplID4gY2FudmFzLndpZHRoKSB7IC8vIGRvbmsgb24gdGhlIHJpZ2h0XHJcbiAgICAgICAgICAgICAgICBhcnJvd3NbaV0ueCAtPSAyICogKGFycm93c1tpXS54ICsgaGFsZkFycm93U2l6ZSAtIGNhbnZhcy53aWR0aCk7XHJcbiAgICAgICAgICAgICAgICBhcnJvd3NbaV0udmVsb2NpdHlYID0gLWFycm93c1tpXS52ZWxvY2l0eVg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGFycm93c1tpXS55ICsgaGFsZkFycm93U2l6ZSA+IGNhbnZhcy5oZWlnaHQpIHsgLy8gZG9uayBvbiB0aGUgYm90dG9tXHJcbiAgICAgICAgICAgICAgICBhcnJvd3NbaV0ueSAtPSAyICogKGFycm93c1tpXS55ICsgaGFsZkFycm93U2l6ZSAtIGNhbnZhcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgYXJyb3dzW2ldLnZlbG9jaXR5WSA9IC1hcnJvd3NbaV0udmVsb2NpdHlZO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChtb3VzZURvd24pIHtcclxuICAgICAgICBnZW5lcmF0ZUFycm93KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdXBkYXRlIHRoZSBVSVxyXG4gICAgYXJyb3dDb3VudGVyLmlubmVyVGV4dCA9IGFycm93cy5sZW5ndGgudG9TdHJpbmcoKTtcclxuICAgIGlmIChwcmV2aW91c0ZyYW1lVGltZXMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgIGZwc0NvdW50ZXIuaW5uZXJIVE1MID0gTWF0aC5yb3VuZCgxMDAwIC8gZGVsdGFUaW1lTWlsbGlzKS50b1N0cmluZygpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBmcHNDb3VudGVyLmlubmVySFRNTCA9IFwidW5rbm93blwiO1xyXG4gICAgfVxyXG5cclxuICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcclxuXHJcbiAgICAvLyBkcmF3IHRoZSBhcnJvd3NcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyb3dzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgZHJhd0Fycm93KGFycm93c1tpXSk7XHJcbiAgICB9XHJcblxyXG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShkcmF3KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2VuZXJhdGVBcnJvdygpIHtcclxuICAgIGxldCBhcnJvdzogQXJyb3cgPSBuZXcgQXJyb3coKTtcclxuICAgIGFycm93LnggPSBjbGFtcFZhbHVlVG9SYW5nZShtb3VzZVgsIDAsIGNhbnZhcy53aWR0aCk7XHJcbiAgICBhcnJvdy55ID0gY2xhbXBWYWx1ZVRvUmFuZ2UobW91c2VZLCAwLCBjYW52YXMuaGVpZ2h0KTtcclxuICAgIFxyXG4gICAgbGV0IHZlbG9jaXR5TWFnbml0dWRlUGl4ZWxzUGVyTWlsbGlzZWNvbmQ6IG51bWJlciA9IDAuNDtcclxuICAgIGxldCByYW5kb21BbmdsZTogbnVtYmVyID0gTWF0aC5yYW5kb20oKSAqIDIgKiBNYXRoLlBJO1xyXG4gICAgYXJyb3cudmVsb2NpdHlYID0gTWF0aC5jb3MocmFuZG9tQW5nbGUpICogdmVsb2NpdHlNYWduaXR1ZGVQaXhlbHNQZXJNaWxsaXNlY29uZDtcclxuICAgIGFycm93LnZlbG9jaXR5WSA9IE1hdGguc2luKHJhbmRvbUFuZ2xlKSAqIHZlbG9jaXR5TWFnbml0dWRlUGl4ZWxzUGVyTWlsbGlzZWNvbmQ7XHJcblxyXG4gICAgYXJyb3cuY29sb3JJbmRleCA9IGdldFJhbmRvbUludEluY2x1c2l2ZSgwLCAxMSk7XHJcbiAgICBhcnJvdy5yb3RhdGlvbkluZGV4ID0gZ2V0UmFuZG9tSW50SW5jbHVzaXZlKDAsIDMpO1xyXG5cclxuICAgIGFycm93cy5wdXNoKGFycm93KTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xhbXBWYWx1ZVRvUmFuZ2UodmFsdWU6IG51bWJlciwgbG93ZXJCb3VuZDogbnVtYmVyLCB1cHBlckJvdW5kOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgaWYgKHZhbHVlIDwgbG93ZXJCb3VuZCkge1xyXG4gICAgICAgIHJldHVybiBsb3dlckJvdW5kO1xyXG4gICAgfVxyXG4gICAgaWYgKHZhbHVlID4gdXBwZXJCb3VuZCkge1xyXG4gICAgICAgIHJldHVybiB1cHBlckJvdW5kO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRSYW5kb21JbnRJbmNsdXNpdmUobWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogbnVtYmVyIHtcclxuICAgIG1pbiA9IE1hdGguY2VpbChtaW4pO1xyXG4gICAgbWF4ID0gTWF0aC5mbG9vcihtYXgpO1xyXG4gICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSArIG1pbik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRyYXdBcnJvdyhhcnJvdzogQXJyb3cpIHtcclxuICAgIGN0eC5zYXZlKCk7XHJcbiAgICBjdHgudHJhbnNsYXRlKGFycm93LngsIGFycm93LnkpO1xyXG4gICAgY3R4LnJvdGF0ZShhcnJvdy5yb3RhdGlvbkluZGV4ICogTWF0aC5QSSAvIDIpO1xyXG4gICAgY3R4LmRyYXdJbWFnZShhcnJvd0NvbG9yc1thcnJvdy5jb2xvckluZGV4XSwgLWhhbGZBcnJvd1NpemUsIC1oYWxmQXJyb3dTaXplLCBhcnJvd1NpemUsIGFycm93U2l6ZSk7XHJcbiAgICBjdHgucmVzdG9yZSgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkcmF3QXJyb3dOb1Jlc2l6aW5nKGFycm93OiBBcnJvdykge1xyXG4gICAgbGV0IGNhY2hlZENhbnZhczogSFRNTENhbnZhc0VsZW1lbnQgPSBhcnJvd0NhY2hlUmVzaXplZFswXVthcnJvdy5jb2xvckluZGV4XTtcclxuICAgIGN0eC5zYXZlKCk7XHJcbiAgICBjdHgudHJhbnNsYXRlKGFycm93LngsIGFycm93LnkpO1xyXG4gICAgY3R4LnJvdGF0ZShhcnJvdy5yb3RhdGlvbkluZGV4ICogTWF0aC5QSSAvIDIpO1xyXG4gICAgY3R4LmRyYXdJbWFnZShjYWNoZWRDYW52YXMsIC1oYWxmQXJyb3dTaXplLCAtaGFsZkFycm93U2l6ZSwgYXJyb3dTaXplLCBhcnJvd1NpemUpO1xyXG4gICAgY3R4LnJlc3RvcmUoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZHJhd0Fycm93Tm9Sb3RhdGluZyhhcnJvdzogQXJyb3cpIHtcclxuICAgIGxldCBjYWNoZWRDYW52YXM6IEhUTUxDYW52YXNFbGVtZW50ID0gYXJyb3dDYWNoZU5vdFJlc2l6ZWRbYXJyb3cucm90YXRpb25JbmRleF1bYXJyb3cuY29sb3JJbmRleF07XHJcbiAgICBjdHguc2F2ZSgpO1xyXG4gICAgY3R4LmRyYXdJbWFnZShjYWNoZWRDYW52YXMsIGFycm93LnggLSBoYWxmQXJyb3dTaXplLCBhcnJvdy55IC0gaGFsZkFycm93U2l6ZSwgYXJyb3dTaXplLCBhcnJvd1NpemUpO1xyXG4gICAgY3R4LnJlc3RvcmUoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZHJhd0Fycm93Tm9SZXN6aW5nT3JSb3RhdGluZyhhcnJvdzogQXJyb3cpIHtcclxuICAgIGxldCBjYWNoZWRDYW52YXM6IEhUTUxDYW52YXNFbGVtZW50ID0gYXJyb3dDYWNoZVJlc2l6ZWRbYXJyb3cucm90YXRpb25JbmRleF1bYXJyb3cuY29sb3JJbmRleF07XHJcbiAgICBjdHguc2F2ZSgpO1xyXG4gICAgY3R4LmRyYXdJbWFnZShjYWNoZWRDYW52YXMsIGFycm93LnggLSBoYWxmQXJyb3dTaXplLCBhcnJvdy55IC0gaGFsZkFycm93U2l6ZSwgYXJyb3dTaXplLCBhcnJvd1NpemUpO1xyXG4gICAgY3R4LnJlc3RvcmUoKTtcclxufVxyXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=